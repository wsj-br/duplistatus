"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[3109],{1285:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>a});var i=s(3303);const t={},o=i.createContext(t);function r(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(o.Provider,{value:n},e.children)}},4823:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"api-reference/authentication-security","title":"Authentication & Security","description":"The API uses a combination of session-based authentication and CSRF protection for all database write operations to prevent unauthorized access and potential denial-of-service attacks. External APIs (used by Duplicati) remain unauthenticated for compatibility.","source":"@site/docs/api-reference/authentication-security.md","sourceDirName":"api-reference","slug":"/api-reference/authentication-security","permalink":"/duplistatus/api-reference/authentication-security","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"mainSidebar","previous":{"title":"API Overview","permalink":"/duplistatus/api-reference/overview"},"next":{"title":"Core Operations","permalink":"/duplistatus/api-reference/core-operations"}}');var t=s(7711),o=s(1285);const r={},a="Authentication & Security",c={},d=[{value:"Session-Based Authentication",id:"session-based-authentication",level:2},{value:"Session Management",id:"session-management",level:3},{value:"CSRF Protection",id:"csrf-protection",level:3},{value:"Protected Endpoints",id:"protected-endpoints",level:3},{value:"Unprotected Endpoints",id:"unprotected-endpoints",level:3},{value:"Usage Example (Session + CSRF)",id:"usage-example-session--csrf",level:3},{value:"Error Responses",id:"error-responses",level:3}];function l(e){const n={code:"code",div:"div",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"authentication--security",children:"Authentication & Security"})}),"\n",(0,t.jsx)(n.p,{children:"The API uses a combination of session-based authentication and CSRF protection for all database write operations to prevent unauthorized access and potential denial-of-service attacks. External APIs (used by Duplicati) remain unauthenticated for compatibility."}),"\n",(0,t.jsx)(n.h2,{id:"session-based-authentication",children:"Session-Based Authentication"}),"\n",(0,t.jsx)(n.p,{children:"Protected endpoints require a valid session cookie and CSRF token. The session system provides secure authentication for all protected operations."}),"\n",(0,t.jsx)(n.h3,{id:"session-management",children:"Session Management"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create Session"}),": POST to ",(0,t.jsx)(n.code,{children:"/api/session"})," to create a new session"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Get CSRF Token"}),": GET ",(0,t.jsx)(n.code,{children:"/api/csrf"})," to obtain a CSRF token for the session"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Include in Requests"}),": Send session cookie and CSRF token with protected requests"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Validate Session"}),": GET ",(0,t.jsx)(n.code,{children:"/api/session"})," to check if session is still valid"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Delete Session"}),": DELETE ",(0,t.jsx)(n.code,{children:"/api/session"})," to logout and clear session"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"csrf-protection",children:"CSRF Protection"}),"\n",(0,t.jsxs)(n.p,{children:["All state-changing operations require a valid CSRF token that matches the current session. The CSRF token must be included in the ",(0,t.jsx)(n.code,{children:"X-CSRF-Token"})," header for protected endpoints."]}),"\n",(0,t.jsx)(n.h3,{id:"protected-endpoints",children:"Protected Endpoints"}),"\n",(0,t.jsx)(n.p,{children:"All endpoints that modify database data require session authentication and CSRF token:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Server Management"}),": ",(0,t.jsx)(n.code,{children:"/api/servers/:id"})," (PATCH, DELETE), ",(0,t.jsx)(n.code,{children:"/api/servers/:id/server-url"})," (PATCH), ",(0,t.jsx)(n.code,{children:"/api/servers/:id/password"})," (PATCH, GET)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Configuration Management"}),": ",(0,t.jsx)(n.code,{children:"/api/configuration/email"})," (GET, POST, DELETE), ",(0,t.jsx)(n.code,{children:"/api/configuration/unified"})," (GET), ",(0,t.jsx)(n.code,{children:"/api/configuration/ntfy"})," (GET), ",(0,t.jsx)(n.code,{children:"/api/configuration/notifications"})," (GET, POST), ",(0,t.jsx)(n.code,{children:"/api/configuration/backup-settings"})," (POST), ",(0,t.jsx)(n.code,{children:"/api/configuration/templates"})," (POST), ",(0,t.jsx)(n.code,{children:"/api/configuration/overdue-tolerance"})," (GET, POST)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Backup Management"}),": ",(0,t.jsx)(n.code,{children:"/api/backups/*"})," (DELETE, POST)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Notification System"}),": ",(0,t.jsx)(n.code,{children:"/api/notifications/*"})," (POST)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Cron Configuration"}),": ",(0,t.jsx)(n.code,{children:"/api/cron-config"})," (POST)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Session Management"}),": ",(0,t.jsx)(n.code,{children:"/api/session"})," (POST, GET, DELETE), ",(0,t.jsx)(n.code,{children:"/api/csrf"})," (GET)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Chart Data"}),": ",(0,t.jsx)(n.code,{children:"/api/chart-data/*"})," (GET)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Dashboard"}),": ",(0,t.jsx)(n.code,{children:"/api/dashboard"})," (GET)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Server Details"}),": ",(0,t.jsx)(n.code,{children:"/api/servers"})," (GET), ",(0,t.jsx)(n.code,{children:"/api/servers/:id"})," (GET), ",(0,t.jsx)(n.code,{children:"/api/detail/:serverId"})," (GET)"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"unprotected-endpoints",children:"Unprotected Endpoints"}),"\n",(0,t.jsx)(n.p,{children:"External APIs remain unauthenticated for Duplicati integration:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/api/upload"})," - Backup data uploads from Duplicati"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/api/lastbackup/:serverId"})," - Latest backup status"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/api/lastbackups/:serverId"})," - Latest backups status"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/api/summary"})," - Overall summary data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/api/health"})," - Health check endpoint"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"usage-example-session--csrf",children:"Usage Example (Session + CSRF)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// 1. Create session\nconst sessionResponse = await fetch('/api/session', { method: 'POST' });\nconst { sessionId } = await sessionResponse.json();\n\n// 2. Get CSRF token\nconst csrfResponse = await fetch('/api/csrf', {\n  headers: { 'Cookie': `session=${sessionId}` }\n});\nconst { csrfToken } = await csrfResponse.json();\n\n// 3. Make protected request\nconst response = await fetch('/api/servers/server-id', {\n  method: 'PATCH',\n  headers: {\n    'Content-Type': 'application/json',\n    'X-CSRF-Token': csrfToken,\n    'Cookie': `session=${sessionId}`\n  },\n  body: JSON.stringify({\n    alias: 'Updated Server Name',\n    note: 'Updated notes'\n  })\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"error-responses",children:"Error Responses"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"401 Unauthorized"}),": Invalid or missing session, expired session, or CSRF token validation failed"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"403 Forbidden"}),": CSRF token validation failed or operation not allowed"]}),"\n"]}),"\n",(0,t.jsxs)(n.div,{className:"markdown-alert markdown-alert-caution",children:["\n",(0,t.jsxs)(n.p,{className:"markdown-alert-title",children:[(0,t.jsx)(n.span,{className:"octicon octicon-caution",style:{"--oct-icon":"url(\"data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' class='octicon octicon-stop mr-2' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z'%3E%3C/path%3E%3C/svg%3E\")"}}),"Caution"]}),"\n",(0,t.jsxs)(n.p,{children:["Don't expose the ",(0,t.jsx)(n.strong,{children:"duplistatus"})," server to the public internet. Use it in a secure network\n(e.g., local LAN protected by a firewall)."]}),"\n",(0,t.jsxs)(n.p,{children:["Exposing the ",(0,t.jsx)(n.strong,{children:"duplistatus"})," interface to the public\ninternet without proper security measures could lead to unauthorized access."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}}}]);