"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[5059],{62566(e,s,n){n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"api-reference/authentication-security","title":"Authentication & Security","description":"authentication-security}","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/api-reference/authentication-security.md","sourceDirName":"api-reference","slug":"/api-reference/authentication-security","permalink":"/duplistatus/pt-BR/api-reference/authentication-security","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"mainSidebar","previous":{"title":"API Overview","permalink":"/duplistatus/pt-BR/api-reference/overview"},"next":{"title":"Core Operations","permalink":"/duplistatus/pt-BR/api-reference/core-operations"}}');var r=n(36259),d=n(73230);const o={},c="Authentication & Security {#authentication-security}",l={},t=[{value:"Session-Based Authentication",id:"session-based-authentication",level:2},{value:"Session Management",id:"session-management",level:3},{value:"CSRF Protection",id:"csrf-protection",level:3},{value:"Protected Endpoints",id:"protected-endpoints",level:3},{value:"Unprotected Endpoints",id:"unprotected-endpoints",level:3},{value:"Usage Example (Session + CSRF)",id:"usage-example-session-csrf",level:3},{value:"Authentication Endpoints",id:"authentication-endpoints",level:2},{value:"Login - <code>/api/auth/login</code>",id:"login-apiauthlogin",level:3},{value:"Logout - <code>/api/auth/logout</code>",id:"logout-apiauthlogout",level:3},{value:"Get Current User - <code>/api/auth/me</code>",id:"get-current-user-apiauthme",level:3},{value:"Change Password - <code>/api/auth/change-password</code>",id:"change-password-apiauthchange-password",level:3},{value:"Check Admin Must Change Password - <code>/api/auth/admin-must-change-password</code>",id:"check-admin-must-change-password-apiauthadmin-must-change-password",level:3},{value:"Get Password Policy - <code>/api/auth/password-policy</code>",id:"get-password-policy-apiauthpassword-policy",level:3},{value:"Auth API error and success codes (i18n)",id:"auth-api-error-and-success-codes-i18n",level:3},{value:"Error Responses",id:"error-responses",level:3}];function a(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"authentication-security",children:"Authentication & Security"})}),"\n",(0,r.jsx)(s.p,{children:"The API uses a combination of session-based authentication and CSRF protection for all database write operations to prevent unauthorized access and potential denial-of-service attacks. External APIs (used by Duplicati) remain unauthenticated for compatibility."}),"\n",(0,r.jsx)(s.h2,{id:"session-based-authentication",children:"Session-Based Authentication"}),"\n",(0,r.jsx)(s.p,{children:"Protected endpoints require a valid session cookie and CSRF token. The session system provides secure authentication for all protected operations."}),"\n",(0,r.jsx)(s.h3,{id:"session-management",children:"Session Management"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Create Session"}),": POST to ",(0,r.jsx)(s.code,{children:"/api/session"})," to create a new session"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Get CSRF Token"}),": GET ",(0,r.jsx)(s.code,{children:"/api/csrf"})," to obtain a CSRF token for the session"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Include in Requests"}),": Send session cookie and CSRF token with protected requests"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Validate Session"}),": GET ",(0,r.jsx)(s.code,{children:"/api/session"})," to check if session is still valid"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Delete Session"}),": DELETE ",(0,r.jsx)(s.code,{children:"/api/session"})," to logout and clear session"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"csrf-protection",children:"CSRF Protection"}),"\n",(0,r.jsxs)(s.p,{children:["All state-changing operations require a valid CSRF token that matches the current session. The CSRF token must be included in the ",(0,r.jsx)(s.code,{children:"X-CSRF-Token"})," header for protected endpoints."]}),"\n",(0,r.jsx)(s.h3,{id:"protected-endpoints",children:"Protected Endpoints"}),"\n",(0,r.jsx)(s.p,{children:"All endpoints that modify database data require session authentication and CSRF token:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Server Management"}),": ",(0,r.jsx)(s.code,{children:"/api/servers/:id"})," (PATCH, DELETE), ",(0,r.jsx)(s.code,{children:"/api/servers/:id/server-url"})," (PATCH), ",(0,r.jsx)(s.code,{children:"/api/servers/:id/password"})," (PATCH, GET)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Configuration Management"}),": ",(0,r.jsx)(s.code,{children:"/api/configuration/email"})," (GET, POST, DELETE), ",(0,r.jsx)(s.code,{children:"/api/configuration/unified"})," (GET), ",(0,r.jsx)(s.code,{children:"/api/configuration/ntfy"})," (GET), ",(0,r.jsx)(s.code,{children:"/api/configuration/notifications"})," (GET, POST), ",(0,r.jsx)(s.code,{children:"/api/configuration/backup-settings"})," (POST), ",(0,r.jsx)(s.code,{children:"/api/configuration/templates"})," (POST), ",(0,r.jsx)(s.code,{children:"/api/configuration/overdue-tolerance"})," (GET, POST)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Notification System"}),": ",(0,r.jsx)(s.code,{children:"/api/notifications/test"})," (POST)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Cron Configuration"}),": ",(0,r.jsx)(s.code,{children:"/api/cron-config"})," (GET, POST)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Cron Proxy"}),": ",(0,r.jsx)(s.code,{children:"/api/cron/*"})," (GET, POST) - proxies requests to the cron service"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Session Management"}),": ",(0,r.jsx)(s.code,{children:"/api/session"})," (POST, GET, DELETE), ",(0,r.jsx)(s.code,{children:"/api/csrf"})," (GET)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Chart Data"}),": ",(0,r.jsx)(s.code,{children:"/api/chart-data/*"})," (GET)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Dashboard"}),": ",(0,r.jsx)(s.code,{children:"/api/dashboard"})," (GET)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Server Details"}),": ",(0,r.jsx)(s.code,{children:"/api/servers"})," (GET), ",(0,r.jsx)(s.code,{children:"/api/servers/:id"})," (GET), ",(0,r.jsx)(s.code,{children:"/api/detail/:serverId"})," (GET)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Audit Log"}),": ",(0,r.jsx)(s.code,{children:"/api/audit-log"})," (GET), ",(0,r.jsx)(s.code,{children:"/api/audit-log/download"})," (GET), ",(0,r.jsx)(s.code,{children:"/api/audit-log/filters"})," (GET), ",(0,r.jsx)(s.code,{children:"/api/audit-log/retention"})," (PATCH), ",(0,r.jsx)(s.code,{children:"/api/audit-log/cleanup"})," (POST) - admin required for write operations"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"User Management"}),": ",(0,r.jsx)(s.code,{children:"/api/users"})," (GET, POST, PATCH, DELETE) - admin required"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Database Management"}),": ",(0,r.jsx)(s.code,{children:"/api/database/backup"})," (GET), ",(0,r.jsx)(s.code,{children:"/api/database/restore"})," (POST) - admin required"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Application Logs"}),": ",(0,r.jsx)(s.code,{children:"/api/application-logs"})," (GET), ",(0,r.jsx)(s.code,{children:"/api/application-logs/export"})," (GET) - admin required"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Backup Collection"}),": ",(0,r.jsx)(s.code,{children:"/api/backups/collect"})," (POST) - requires session and CSRF token"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Backup Schedule Sync"}),": ",(0,r.jsx)(s.code,{children:"/api/backups/sync-schedule"})," (POST) - requires session and CSRF token"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Overdue Check"}),": ",(0,r.jsx)(s.code,{children:"/api/notifications/check-overdue"})," (POST) - requires session and CSRF token"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Clear Overdue Timestamps"}),": ",(0,r.jsx)(s.code,{children:"/api/notifications/clear-overdue-timestamps"})," (POST) - requires session and CSRF token"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"unprotected-endpoints",children:"Unprotected Endpoints"}),"\n",(0,r.jsx)(s.p,{children:"External APIs remain unauthenticated for Duplicati integration:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"/api/upload"})," - Backup data uploads from Duplicati"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"/api/lastbackup/:serverId"})," - Latest backup status"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"/api/lastbackups/:serverId"})," - Latest backups status"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"/api/summary"})," - Overall summary data"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"/api/health"})," - Health check endpoint"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"usage-example-session-csrf",children:"Usage Example (Session + CSRF)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"// 1. Create session\nconst sessionResponse = await fetch('/api/session', { method: 'POST' });\nconst { sessionId } = await sessionResponse.json();\n\n// 2. Get CSRF token\nconst csrfResponse = await fetch('/api/csrf', {\n  headers: { 'Cookie': `session=${sessionId}` }\n});\nconst { csrfToken } = await csrfResponse.json();\n\n// 3. Make protected request\nconst response = await fetch('/api/servers/server-id', {\n  method: 'PATCH',\n  headers: {\n    'Content-Type': 'application/json',\n    'X-CSRF-Token': csrfToken,\n    'Cookie': `session=${sessionId}`\n  },\n  body: JSON.stringify({\n    alias: 'Updated Server Name',\n    note: 'Updated notes'\n  })\n});\n"})}),"\n",(0,r.jsx)(s.h2,{id:"authentication-endpoints",children:"Authentication Endpoints"}),"\n",(0,r.jsxs)(s.h3,{id:"login-apiauthlogin",children:["Login - ",(0,r.jsx)(s.code,{children:"/api/auth/login"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Endpoint"}),": ",(0,r.jsx)(s.code,{children:"/api/auth/login"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Method"}),": POST"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Description"}),": Authenticates a user and creates a session. Supports account locking after failed attempts and password change requirements."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Authentication"}),": Requires valid session and CSRF token (but no logged-in user)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Request Body"}),":","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "username": "admin",\n  "password": "password123"\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Response"})," (success):","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "user": {\n    "id": "user-id",\n    "username": "admin",\n    "isAdmin": true,\n    "mustChangePassword": false\n  },\n  "keyChanged": false\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Error Responses"}),": All error responses include ",(0,r.jsx)(s.code,{children:"error"})," (English message) and ",(0,r.jsx)(s.code,{children:"errorCode"})," (stable code for client-side translation).","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"400"}),": Missing username or password \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "REQUIRED_CREDENTIALS"'})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"401"}),": Invalid username or password \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "INVALID_CREDENTIALS"'})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"403"}),": Account locked due to too many failed login attempts \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "ACCOUNT_LOCKED"'})," (includes ",(0,r.jsx)(s.code,{children:"lockedUntil"}),", ",(0,r.jsx)(s.code,{children:"minutesRemaining"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"500"}),": Internal server error \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "INTERNAL_ERROR"'})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"503"}),": Database not ready \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "DATABASE_NOT_READY"'})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Notes"}),":","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Account is locked after 5 failed login attempts for 15 minutes"}),"\n",(0,r.jsx)(s.li,{children:"Failed login attempts are tracked and logged"}),"\n",(0,r.jsx)(s.li,{children:"Session cookie is automatically set in the response"}),"\n",(0,r.jsxs)(s.li,{children:["If user has ",(0,r.jsx)(s.code,{children:"mustChangePassword"})," flag set, they should be redirected to change password page"]}),"\n",(0,r.jsx)(s.li,{children:"All login attempts (successful and failed) are logged to audit log"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.h3,{id:"logout-apiauthlogout",children:["Logout - ",(0,r.jsx)(s.code,{children:"/api/auth/logout"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Endpoint"}),": ",(0,r.jsx)(s.code,{children:"/api/auth/logout"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Method"}),": POST"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Description"}),": Logs out the current user and destroys their session."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Authentication"}),": Requires valid session and CSRF token"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Response"})," (success):","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "message": "Logged out successfully",\n  "successCode": "LOGGED_OUT"\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Error Responses"}),": Include ",(0,r.jsx)(s.code,{children:"error"})," and ",(0,r.jsx)(s.code,{children:"errorCode"})," for client-side translation.","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"400"}),": No active session \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "NO_ACTIVE_SESSION"'})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"500"}),": Internal server error \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "INTERNAL_ERROR"'})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Notes"}),":","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Session cookie is cleared in the response"}),"\n",(0,r.jsx)(s.li,{children:"Logout is logged to audit log"}),"\n",(0,r.jsx)(s.li,{children:"Session is immediately invalidated"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.h3,{id:"get-current-user-apiauthme",children:["Get Current User - ",(0,r.jsx)(s.code,{children:"/api/auth/me"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Endpoint"}),": ",(0,r.jsx)(s.code,{children:"/api/auth/me"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Method"}),": GET"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Description"}),": Returns the current authenticated user information, or indicates if no user is logged in."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Authentication"}),": Requires valid session (but no logged-in user required)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Response"})," (authenticated):","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "authenticated": true,\n  "user": {\n    "id": "user-id",\n    "username": "admin",\n    "isAdmin": true,\n    "mustChangePassword": false\n  }\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Response"})," (not authenticated):","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "authenticated": false,\n  "user": null\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Error Responses"}),": Include ",(0,r.jsx)(s.code,{children:"error"})," and ",(0,r.jsx)(s.code,{children:"errorCode"})," for client-side translation.","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"500"}),": Internal server error \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "INTERNAL_ERROR"'})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Notes"}),":","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Can be called without a logged-in user (returns ",(0,r.jsx)(s.code,{children:"authenticated: false"}),")"]}),"\n",(0,r.jsx)(s.li,{children:"Useful for checking authentication status on page load"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.h3,{id:"change-password-apiauthchange-password",children:["Change Password - ",(0,r.jsx)(s.code,{children:"/api/auth/change-password"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Endpoint"}),": ",(0,r.jsx)(s.code,{children:"/api/auth/change-password"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Method"}),": POST"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Description"}),": Changes the password for the current authenticated user. If ",(0,r.jsx)(s.code,{children:"mustChangePassword"})," is set, current password verification is skipped."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Authentication"}),": Requires valid session and CSRF token (logged-in user required)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Request Body"}),":","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "currentPassword": "old-password",\n  "newPassword": "new-secure-password"\n}\n'})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"currentPassword"}),": Optional if ",(0,r.jsx)(s.code,{children:"mustChangePassword"})," is true, required otherwise"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"newPassword"}),": Required, must meet password policy requirements"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Response"})," (success):","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "message": "Password changed successfully",\n  "successCode": "PASSWORD_CHANGED"\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Error Responses"}),": Include ",(0,r.jsx)(s.code,{children:"error"})," and ",(0,r.jsx)(s.code,{children:"errorCode"})," for client-side translation. Policy violation may include ",(0,r.jsx)(s.code,{children:"validationErrors"})," (array of strings).","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"400"}),": Missing new password \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "NEW_PASSWORD_REQUIRED"'})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"400"}),": Password policy violation \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "POLICY_NOT_MET"'})," (may include ",(0,r.jsx)(s.code,{children:"validationErrors"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"400"}),": New password same as current \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "NEW_PASSWORD_SAME_AS_CURRENT"'})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"401"}),": Current password is incorrect \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "CURRENT_PASSWORD_INCORRECT"'})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"404"}),": User not found \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "USER_NOT_FOUND"'})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"500"}),": Internal server error \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "INTERNAL_ERROR"'})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Notes"}),":","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"New password must meet password policy requirements (length, complexity, etc.)"}),"\n",(0,r.jsxs)(s.li,{children:["If ",(0,r.jsx)(s.code,{children:"mustChangePassword"})," flag is set, current password verification is skipped"]}),"\n",(0,r.jsxs)(s.li,{children:["After successful password change, ",(0,r.jsx)(s.code,{children:"mustChangePassword"})," flag is cleared"]}),"\n",(0,r.jsx)(s.li,{children:"Password changes are logged to audit log"}),"\n",(0,r.jsx)(s.li,{children:"New password must be different from current password"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.h3,{id:"check-admin-must-change-password-apiauthadmin-must-change-password",children:["Check Admin Must Change Password - ",(0,r.jsx)(s.code,{children:"/api/auth/admin-must-change-password"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Endpoint"}),": ",(0,r.jsx)(s.code,{children:"/api/auth/admin-must-change-password"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Method"}),": GET"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Description"}),": Checks if the admin user must change their password. This endpoint is public (no authentication required) as it only returns a boolean flag."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Response"}),":","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "mustChangePassword": false\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Error Responses"}),":","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"500"}),": Internal server error (returns ",(0,r.jsx)(s.code,{children:"mustChangePassword: false"})," on error to avoid showing tip if there's a database issue)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Notes"}),":","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Public endpoint, no authentication required"}),"\n",(0,r.jsxs)(s.li,{children:["Returns ",(0,r.jsx)(s.code,{children:"false"})," if admin user doesn't exist"]}),"\n",(0,r.jsx)(s.li,{children:"Used to determine if password change tip should be shown"}),"\n",(0,r.jsxs)(s.li,{children:["On error, returns ",(0,r.jsx)(s.code,{children:"false"})," to avoid showing tip if there's a database issue"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.h3,{id:"get-password-policy-apiauthpassword-policy",children:["Get Password Policy - ",(0,r.jsx)(s.code,{children:"/api/auth/password-policy"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Endpoint"}),": ",(0,r.jsx)(s.code,{children:"/api/auth/password-policy"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Method"}),": GET"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Description"}),": Returns the current password policy configuration. This endpoint is public (no authentication required) as it's needed for frontend validation."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Response"}),":","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "minLength": 8,\n  "requireUppercase": true,\n  "requireLowercase": true,\n  "requireNumbers": true,\n  "requireSpecialChars": false\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Error Responses"}),": Include ",(0,r.jsx)(s.code,{children:"error"})," and ",(0,r.jsx)(s.code,{children:"errorCode"})," for client-side translation.","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"500"}),": Failed to retrieve password policy \u2014 ",(0,r.jsx)(s.code,{children:'errorCode: "POLICY_RETRIEVE_FAILED"'})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Notes"}),":","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Public endpoint, no authentication required"}),"\n",(0,r.jsx)(s.li,{children:"Used by frontend components to display password requirements and validate passwords before submission"}),"\n",(0,r.jsxs)(s.li,{children:["Policy is configured via environment variables (",(0,r.jsx)(s.code,{children:"PWD_ENFORCE"}),", ",(0,r.jsx)(s.code,{children:"PWD_MIN_LEN"}),")"]}),"\n",(0,r.jsx)(s.li,{children:"Default password check (preventing use of default admin password) is always enforced regardless of policy settings"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"auth-api-error-and-success-codes-i18n",children:"Auth API error and success codes (i18n)"}),"\n",(0,r.jsxs)(s.p,{children:["Auth endpoints return a stable ",(0,r.jsx)(s.code,{children:"errorCode"})," (and, on success, ",(0,r.jsx)(s.code,{children:"successCode"}),") in addition to the human-readable ",(0,r.jsx)(s.code,{children:"error"})," or ",(0,r.jsx)(s.code,{children:"message"})," field. The ",(0,r.jsx)(s.code,{children:"error"})," and ",(0,r.jsx)(s.code,{children:"message"})," values are in English. Clients should use the codes to look up localized strings so that the UI displays messages in the user's selected language."]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Endpoint"}),(0,r.jsx)(s.th,{children:"Success code"}),(0,r.jsx)(s.th,{children:"Error codes"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/api/auth/login"})}),(0,r.jsx)(s.td,{children:"\u2014"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"REQUIRED_CREDENTIALS"}),", ",(0,r.jsx)(s.code,{children:"INVALID_CREDENTIALS"}),", ",(0,r.jsx)(s.code,{children:"ACCOUNT_LOCKED"}),", ",(0,r.jsx)(s.code,{children:"DATABASE_NOT_READY"}),", ",(0,r.jsx)(s.code,{children:"INTERNAL_ERROR"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/api/auth/logout"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"LOGGED_OUT"})}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"NO_ACTIVE_SESSION"}),", ",(0,r.jsx)(s.code,{children:"INTERNAL_ERROR"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/api/auth/me"})}),(0,r.jsx)(s.td,{children:"\u2014"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"INTERNAL_ERROR"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/api/auth/change-password"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"PASSWORD_CHANGED"})}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"NEW_PASSWORD_REQUIRED"}),", ",(0,r.jsx)(s.code,{children:"POLICY_NOT_MET"}),", ",(0,r.jsx)(s.code,{children:"USER_NOT_FOUND"}),", ",(0,r.jsx)(s.code,{children:"CURRENT_PASSWORD_INCORRECT"}),", ",(0,r.jsx)(s.code,{children:"NEW_PASSWORD_SAME_AS_CURRENT"}),", ",(0,r.jsx)(s.code,{children:"INTERNAL_ERROR"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/api/auth/password-policy"})}),(0,r.jsx)(s.td,{children:"\u2014"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"POLICY_RETRIEVE_FAILED"})})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"error-responses",children:"Error Responses"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"401 Unauthorized"}),": Invalid or missing session, expired session, or CSRF token validation failed"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"403 Forbidden"}),": CSRF token validation failed or operation not allowed"]}),"\n"]}),"\n",(0,r.jsxs)(s.admonition,{type:"caution",children:[(0,r.jsxs)(s.p,{children:["Don't expose the ",(0,r.jsx)(s.strong,{children:"duplistatus"})," server to the public internet. Use it in a secure network\n(e.g., local LAN protected by a firewall)."]}),(0,r.jsxs)(s.p,{children:["Exposing the ",(0,r.jsx)(s.strong,{children:"duplistatus"})," interface to the public\ninternet without proper security measures could lead to unauthorized access."]})]})]})}function h(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},73230(e,s,n){n.d(s,{R:()=>o,x:()=>c});var i=n(71299);const r={},d=i.createContext(r);function o(e){const s=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(d.Provider,{value:s},e.children)}}}]);