
# Version 1.0.x {#version-10x}

## Overview {#overview}

Version 1.0.x is a feature release that introduces significant enhancements to email configuration, server management capabilities, and database maintenance tools. This release focuses on improving email notification reliability, expanding SMTP connection options, and providing better tools for managing servers and database integrity.

## New Features {#new-features}

### Server Management Enhancements {#server-management-enhancements}

- **Server password change functionality** - Users can now change server passwords directly from the server detail page by clicking on the key icon
- **Duplicate server detection and merging** - New function in the Database maintenance form to detect duplicate servers and merge them into a single server entry

### Audit Logging Enhancements {#audit-logging-enhancements}

- **Backup upload audit logging** - All backup log uploads via the `/api/upload` endpoint are now automatically logged in the audit log. Each entry includes backup details (server ID, server name, backup name, status, date, duration, file counts, sizes, warnings, and errors) along with client IP address and user agent information for tracking and security purposes

### Email Configuration Enhancements {#email-configuration-enhancements}

- **Configuration incomplete notice** - Visual alert displayed when email settings are not properly configured
- **Service status indicators** - "(disabled)" labels shown on notification checkboxes when email services are not configured
- **Customisable sender information**:
  - `Sender Name` field for customising the display name shown as the sender in email notifications
  - `From Address` field for specifying the email address shown as the sender
  - Note: Some email providers will override the `From Address` with the `SMTP Server Username`
- **SMTP authentication toggle** - Option to enable or disable SMTP authentication, supporting servers that don't require authentication
- **Email format validation** - Validation for recipient and from address fields to ensure proper email address format
- **Enhanced test email** - Test email now displays comprehensive connection details including SMTP server hostname, port, connection type, authentication status, username (if applicable), recipient email, from address, sender name, and test timestamp

### SMTP Connection Type Support {#smtp-connection-type-support}

- **Multiple connection types** - Support for three connection types:
  - `Plain SMTP` (no encryption) on port 25
  - `STARTTLS` (upgrade to TLS) on port 587
  - `Direct SSL/TLS` (encrypted from start) on port 465
- **Default connection type** - Changed to `Direct SSL/TLS` for new configurations
- **Connection-specific requirements** - `From Address` field is required for `Plain SMTP` connections to ensure proper email sender identification and RFC 5322 compliance


---

## üêõ Bug Fixes {#bug-fixes}

### Email System Fixes {#email-system-fixes}

- **Fixed missing `From` header** - Resolved RFC 5322 compliance errors by ensuring all email messages include proper `From` headers
- **Fixed email encryption for STARTTLS** - Corrected encryption handling for `STARTTLS` connections (port 587)
- **Fixed Plain SMTP connections** - Resolved TLS negotiation errors that were causing `Plain SMTP` connections to fail
- **Fixed unsaved configuration loss** - Prevented unsaved email configuration from being cleared when changing password
- **Fixed stale SMTP configuration** - Resolved issue where test email endpoint was using outdated SMTP configuration

### User Interface Fixes {#user-interface-fixes}

- **Fixed password visibility toggle** - Corrected behaviour of the view password feature in the password change form; clicking the eye icon now shows the password for both password fields simultaneously

### System Fixes {#system-fixes}

- **Fixed Docker entrypoint logging** - Resolved issue where Docker entrypoint script was dropping log messages
- **Fixed Next Run date calculation** - Added automatic recalculation of the `Next Run` date after collecting backup logs, ensuring the date is updated correctly after log collection

---

## üöÄ Migration Notes {#migration-notes}

### From Version 0.9.x {#from-version-09x}

This release includes enhancements to email configuration and server management. When upgrading from version 0.9.x:

1. **No Database Migration Required** - This release does not require any database schema changes
2. **Email Configuration Updates** - Existing email configurations will continue to work, but you may want to review and update your settings to take advantage of new features:
   - Consider setting a custom `Sender Name` for better email identification
   - Verify your `From Address` is set correctly, especially if using `Plain SMTP` connections
   - Test your email configuration using the enhanced test email feature
3. **Connection Type Default** - New email configurations will default to `Direct SSL/TLS` connection type
4. **Server Password Management** - You can now change server passwords directly from the server detail page without needing to re-collect backups

### Email Configuration Recommendations {#email-configuration-recommendations}

- **For production use**: Use `STARTTLS` or `Direct SSL/TLS` connections for secure email delivery
- **For local testing**: `Plain SMTP` connections are available for trusted local networks
- **From Address requirement**: When using `Plain SMTP` or when authentication is disabled, ensure the `From Address` field is properly configured
- **Test your configuration**: Always use the "Send Test Email" button to verify your email setup works correctly

---

## API Endpoints {#api-endpoints}

### Email Configuration Endpoints {#email-configuration-endpoints}

- `GET /api/email/config` - Get email configuration
- `POST /api/email/config` - Update email configuration
- `POST /api/email/test` - Send test email
- `DELETE /api/email/config` - Delete email configuration

### Server Management Endpoints {#server-management-endpoints}

- `PATCH /api/servers/{id}/password` - Update server password
- `POST /api/database/maintenance/merge-duplicate-servers` - Merge duplicate servers

---

## Support {#support}

### Getting Help {#getting-help}

- **Documentation**: [User Guide](../user-guide/overview.md)
- **Email Settings**: [Email Configuration Guide](../user-guide/settings/email-settings.md)
- **API Reference**: [API Documentation](../api-reference/overview.md)
- **Migration Guide**: [Version Upgrade Migration](../migration/version_upgrade.md)
- **Community**: [GitHub Discussions](https://github.com/wsj-br/duplistatus/discussions)
- **Issues**: [GitHub Issues](https://github.com/wsj-br/duplistatus/issues)

### Reporting Bugs {#reporting-bugs}

When reporting bugs, please include:
- Version: 1.0.x (specify exact version, e.g., 1.0.3)
- Operating system and version
- Docker/podman version
- Container type (Docker or podman/Pod)
- Error messages and logs
- Steps to reproduce
- Email configuration details (if email-related)
- Podman configuration details (if running in podman/Pod)

---

## Changelog {#changelog}

### Detailed Changes {#detailed-changes}

- **Added**: Server password change functionality from server detail page
- **Added**: Duplicate server detection and merging in database maintenance
- **Added**: `Sender Name` and `From Address` fields to email configuration
- **Added**: Support for `Plain SMTP` connections (port 25)
- **Added**: Connection type selection (`Plain SMTP`, `STARTTLS`, `Direct SSL/TLS`)
- **Added**: SMTP authentication requirement toggle
- **Added**: Email format validation for recipient and from address fields
- **Added**: Enhanced test email with comprehensive connection details
- **Added**: Configuration incomplete notice for email settings
- **Added**: "(disabled)" labels on notification checkboxes when services are not configured
- **Added**: Audit log entries for backup log uploads via `/api/upload` endpoint
- **Changed**: Default connection type to `Direct SSL/TLS` for new configurations
- **Changed**: `From Address` field is now required for `Plain SMTP` connections
- **Fixed**: Missing `From` header in email messages (RFC 5322 compliance)
- **Fixed**: Email encryption for `STARTTLS` connections
- **Fixed**: `Plain SMTP` connections failing with TLS negotiation errors
- **Fixed**: Unsaved email configuration being cleared when changing password
- **Fixed**: Stale SMTP configuration in test email endpoint
- **Fixed**: Password visibility toggle in password change form
- **Fixed**: Docker entrypoint script dropping log messages
- **Fixed**: `Next Run` date not being recalculated after collecting backup logs
- **Improved**: Email configuration user experience with better validation and feedback

---

## License {#license}

This project is licensed under the [Apache License 2.0](https://github.com/wsj-br/duplistatus/blob/main/LICENSE).

**Copyright ¬© 2025 Waldemar Scudeller Jr.**
