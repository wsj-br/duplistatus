# Version 1.3.1 {#version-131}

## Overview {#overview}

Version 1.3.1 introduces full multi-language support for the application interface, strengthens API security with required authentication on additional endpoints, and fixes several bugs related to master key detection, locale formatting, and notification settings. This release focuses on internationalisation improvements and security hardening.

## New Features {#new-features}

### Multi-Language Interface Support {#multi-language-interface-support}

- **Language selector in app header**: Choose your preferred interface language from a dropdown in the user menu. Supported languages: English, Deutsch, Français, Español, and Português (BR). Your selection is saved and persists across sessions.
- **Locale-aware navigation**: All pages and links now support locale-prefixed URLs for consistent navigation in your selected language.

### Notification Templates Internationalization {#notification-templates-internationalization}

- **Template language selector**: Notification templates now support multiple languages with a dedicated language selector. Pre-translated default templates are available for all 5 supported languages.
- **Reset options**: "Reset this template to default" and "Reset all to default" buttons with confirmation dialogs for easy template management when changing languages.
- **Locale-aware notification content**: Dates, times, numbers, and backup status values in notifications are now formatted according to the template language.

### Date and Number Localization {#date-and-number-localization}

- **Locale-aware date and time formatting**: Dates and times throughout the application (dashboard, server details, charts, tooltips) now display in the format appropriate for your locale (e.g. DD/MM/YYYY for European locales, MM/DD/YYYY for English).
- **Locale-aware number formatting**: Numbers, file sizes, and statistics use locale-appropriate formatting (e.g. 1.234,56 for German, 1,234.56 for English).

### RTL Support Preparation {#rtl-support-preparation}

- **Foundation for right-to-left languages**: Infrastructure has been added to support future RTL languages (Arabic, Hebrew). Current languages remain left-to-right.

---

## Security {#security}

### API Authentication {#api-authentication}

- **Required authentication on additional endpoints**: The following endpoints now require a valid session and CSRF token (previously had optional auth):
  - `/api/backups/collect`
  - `/api/backups/sync-schedule`
  - `/api/cron-config` (POST)
  - `/api/notifications/check-overdue`
  - `/api/notifications/clear-overdue-timestamps`
- **Dependency security updates**: Upgraded vulnerable dependencies (fast-xml-parser, brace-expansion) to address known security issues.

---

## Bug Fixes {#bug-fixes}

- **Master key change detection**: Fixed incorrect "key changed" detection when restoring the database and `.duplistatus.key` file together (same key). The system now uses a key fingerprint for reliable detection instead of decryption-based checks that could misinterpret data corruption as a key change.
- **Detail page initial load**: Server detail page now correctly displays overdue messages and data on first load instead of only after the first auto-refresh.

---

## Improvements {#improvements}

### Internationalisation Consistency {#internationalisation-consistency}

- **Common translation strings**: Components now consistently use shared translations for time units, intervals, status labels, and other common strings.
- **Locale-aware weekday ordering**: Weekday display in overdue monitoring respects your locale (Monday–Sunday for UK/Europe, Sunday–Saturday for US/Brazil).

### UI Improvements {#ui-improvements}

- **Server filter width**: Increased server filter width in backup notifications form (260px → 360px) for better usability.
- **Bulk selection**: Enhanced bulk selection UI with proper pluralization support for backup counts.
- **Help tooltips**: Improved help tooltip text with page name context.

### Documentation {#documentation}

- **Configuration page rename**: The timezone and language configuration page has been renamed from `configure-tz-lang` to `configure-tz`.
- **Notification templates guide**: Updated user guide to document the new template language selector, reset buttons, and language behaviour.
- **Multi-language documentation**: User guide now documents how to change the interface language via the language selector in the user menu.

---

## Migration Notes {#migration-notes}

### From Version 1.3.0 {#from-version-130}

When upgrading to version 1.3.1:

1. **API Authentication**: Scripts or tools that call the backups collect, sync-schedule, cron-config, or notification check/clear endpoints must now include valid session authentication and CSRF tokens.

2. **No Database Migration Required**: This release does not require any database schema changes.

3. **Locale Support**: The environment variable `LANG` is no longer used. You can define the language for notifications on the `Settings > Templates` page.

---

## Support {#support}

### Getting Help {#getting-help}

- **Documentation**: [User Guide](../user-guide/overview.md)
- **Email Settings**: [Email Configuration Guide](../user-guide/settings/email-settings.md)
- **API Reference**: [API Documentation](../api-reference/overview.md)
- **Migration Guide**: [Version Upgrade Migration](../migration/version_upgrade.md)
- **Community**: [GitHub Discussions](https://github.com/wsj-br/duplistatus/discussions)
- **Issues**: [GitHub Issues](https://github.com/wsj-br/duplistatus/issues)

### Reporting Bugs {#reporting-bugs}

When reporting bugs, please include:
- Version: 1.3.1
- Operating system and version
- Docker/podman version
- Container type (Docker or podman/Pod)
- Error messages and logs
- Steps to reproduce

---

## Changelog {#changelog}

### Version 1.3.1 Changes {#version-131-changes}

- **Added**: Multi-language interface support with language selector in app header (en, de, fr, es, pt-BR)
- **Added**: Notification templates internationalisation with language selector and pre-translated defaults
- **Added**: Locale-aware date, time, and number formatting throughout the application
- **Added**: RTL support preparation for future right-to-left languages
- **Changed**: API authentication now required on backups collect, sync-schedule, cron-config, and notification endpoints
- **Changed**: Documentation page renamed from configure-tz-lang to configure-tz
- **Changed**: User guide updated for notification templates and multi-language support
- **Fixed**: Master key change detection false positives when restoring database with same key
- **Fixed**: Relative time formatting in non-English locales (overdue monitoring form)
- **Fixed**: Backup notifications form now fully translated in all 5 locales
- **Fixed**: Detail page initial load now shows overdue message and data correctly
- **Fixed**: Localized documentation screenshots for translated docs
- **Improved**: Internationalisation consistency with shared translation strings
- **Improved**: UI improvements (server filter width, bulk selection pluralization, help tooltips)
- **Security**: Upgraded vulnerable dependencies (fast-xml-parser, brace-expansion)

---

## License {#license}

This project is licensed under the [Apache License 2.0](https://github.com/wsj-br/duplistatus/blob/main/LICENSE).

**Copyright © 2025 Waldemar Scudeller Jr.**
