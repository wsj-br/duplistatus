"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[4948],{34670(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"development/test-scripts","title":"Testskripte","description":"test-scripts}","source":"@site/i18n/de/docusaurus-plugin-content-docs/current/development/test-scripts.md","sourceDirName":"development","slug":"/development/test-scripts","permalink":"/duplistatus/de/development/test-scripts","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"translation_last_updated":"2026-02-16T02:21:34.808Z","source_file_mtime":"2026-02-16T00:30:39.430Z","source_file_hash":"6f3df4c1ef3576bd","translation_language":"de","source_file_path":"development/test-scripts.md"},"sidebar":"mainSidebar","previous":{"title":"Versionsverwaltung","permalink":"/duplistatus/de/development/release-management"},"next":{"title":"Workspace-Admin-Skripte und -Befehle","permalink":"/duplistatus/de/development/workspace-admin-scripts-commands"}}');var r=s(36259),t=s(73230);const l={translation_last_updated:"2026-02-16T02:21:34.808Z",source_file_mtime:"2026-02-16T00:30:39.430Z",source_file_hash:"6f3df4c1ef3576bd",translation_language:"de",source_file_path:"development/test-scripts.md"},a="Testskripte {#test-scripts}",d={},c=[{value:"Testdaten generieren",id:"generate-test-data",level:2},{value:"Einblenden der Inhalte \xfcberf\xe4lliger Benachrichtigungen (zum Debuggen des Benachrichtigungssystems)",id:"show-the-overdue-notifications-contents-to-debug-notification-system",level:2},{value:"\xdcberf\xe4llige Pr\xfcfung zu einem bestimmten Datum/einer bestimmten Uhrzeit ausf\xfchren (zum Debuggen des Benachrichtigungssystems)",id:"run-overdue-check-at-a-specific-datetime-to-debug-notification-system",level:2},{value:"Testen der Cron-Service-Port-Konnektivit\xe4t",id:"test-cron-service-port-connectivity",level:2},{value:"Testen der \xdcberf\xe4llig-Erkennung",id:"test-overdue-detection",level:2},{value:"CSV-Exportieren validieren",id:"validate-csv-export",level:2},{value:"NTFY-Server vor\xfcbergehend blockieren (zum Testen)",id:"temporarily-block-ntfy-server-for-testing",level:2},{value:"Datenbankmigrationstests",id:"database-migration-testing",level:2},{value:"Migrationstestdaten generieren",id:"generate-migration-test-data",level:3},{value:"Testen von Datenbankmigrationen",id:"test-database-migrations",level:3},{value:"SMTP-Testkonfiguration festlegen",id:"set-smtp-test-configuration",level:2},{value:"Testen des SMTP-Verbindungstyps \u2013 Plattform\xfcbergreifende Kompatibilit\xe4t",id:"test-smtp-connection-type-cross-compatibility",level:2},{value:"Testen des Docker-Entrypoint-Skripts",id:"test-docker-entrypoint-script",level:2}];function o(e){const n={code:"code",div:"div",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"test-scripts",children:"Testskripte"})}),"\n",(0,r.jsx)(n.p,{children:"Das Projekt enth\xe4lt mehrere Test-Skripte, um bei der Entwicklung und dem Testen zu helfen:"}),"\n",(0,r.jsx)(n.h2,{id:"generate-test-data",children:"Testdaten generieren"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm generate-test-data --servers=N\n"})}),"\n",(0,r.jsx)(n.p,{children:"Dieses Skript generiert Testdaten f\xfcr Sicherungen auf mehreren Servern und Sicherungen."}),"\n",(0,r.jsxs)(n.p,{children:["Der Parameter ",(0,r.jsx)(n.code,{children:"--servers=N"})," ist ",(0,r.jsx)(n.strong,{children:"erforderlich"})," und gibt die Anzahl der zu generierenden Server an (1-30)."]}),"\n",(0,r.jsxs)(n.p,{children:["Verwenden Sie die Option ",(0,r.jsx)(n.code,{children:"--upload"}),", um die generierten Daten an ",(0,r.jsx)(n.code,{children:"/api/upload"})," zu senden."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm generate-test-data --servers=N --upload\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Beispiele:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Generate data for 5 servers\npnpm generate-test-data --servers=5\n\n# Generate data for 1 server with upload mode\npnpm generate-test-data --upload --servers=1\n\n# Generate data for all 30 servers\npnpm generate-test-data --servers=30\n"})}),"\n",(0,r.jsxs)(n.div,{className:"markdown-alert markdown-alert-caution",children:["\n",(0,r.jsxs)(n.p,{className:"markdown-alert-title",children:[(0,r.jsx)(n.span,{className:"octicon octicon-caution",style:{"--oct-icon":"url(\"data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' class='octicon octicon-stop mr-2' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z'%3E%3C/path%3E%3C/svg%3E\")"}}),"Caution"]}),"\n",(0,r.jsx)(n.p,{children:"Dieses Skript l\xf6scht alle vorherigen Daten in der Datenbank und ersetzt sie durch Testdaten.\nSichern Sie Ihre Datenbank, bevor Sie dieses Skript ausf\xfchren."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"show-the-overdue-notifications-contents-to-debug-notification-system",children:"Einblenden der Inhalte \xfcberf\xe4lliger Benachrichtigungen (zum Debuggen des Benachrichtigungssystems)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm show-overdue-notifications\n"})}),"\n",(0,r.jsx)(n.h2,{id:"run-overdue-check-at-a-specific-datetime-to-debug-notification-system",children:"\xdcberf\xe4llige Pr\xfcfung zu einem bestimmten Datum/einer bestimmten Uhrzeit ausf\xfchren (zum Debuggen des Benachrichtigungssystems)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'pnpm run-overdue-check "YYYY-MM-DD HH:MM:SS"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"test-cron-service-port-connectivity",children:"Testen der Cron-Service-Port-Konnektivit\xe4t"}),"\n",(0,r.jsx)(n.p,{children:"Um die Konnektivit\xe4t des Cron-Dienstes zu testen, k\xf6nnen Sie:"}),"\n",(0,r.jsx)(n.p,{children:"Pr\xfcfen Sie, ob der Cron-Dienst ausgef\xfchrt wird:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:8667/health\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Oder verwenden Sie die Cron-Service-API-Endpunkte direkt \xfcber die Hauptanwendung:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:8666/api/cron/health\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Verwenden Sie das Testskript, um die Port-Konnektivit\xe4t zu best\xe4tigen:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm test-cron-port\n"})}),"\n",(0,r.jsx)(n.p,{children:"Dieses Skript testet die Konnektivit\xe4t zum Cron-Service-Port und liefert detaillierte Informationen zum Verbindungsstatus."}),"\n",(0,r.jsx)(n.h2,{id:"test-overdue-detection",children:"Testen der \xdcberf\xe4llig-Erkennung"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm test-overdue-detection\n"})}),"\n",(0,r.jsx)(n.p,{children:"Dieses Skript testet die Erkennungslogik f\xfcr \xfcberf\xe4llige Sicherungen. Es \xfcberpr\xfcft:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Identifikation \xfcberf\xe4lliger Sicherungen"}),"\n",(0,r.jsx)(n.li,{children:"Ausl\xf6sung von Benachrichtigungen"}),"\n",(0,r.jsx)(n.li,{children:'Datums-/Zeitberechnungen f\xfcr den Status "\xfcberf\xe4llig"'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"N\xfctzlich zum Debuggen von Systemen zur Erkennung und Benachrichtigung \xfcberf\xe4lliger Sicherungen."}),"\n",(0,r.jsx)(n.h2,{id:"validate-csv-export",children:"CSV-Exportieren validieren"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm validate-csv-export\n"})}),"\n",(0,r.jsx)(n.p,{children:"Dieses Skript validiert die CSV-Exportfunktionalit\xe4t. Es:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Testet die CSV-Exportgenerierung"}),"\n",(0,r.jsx)(n.li,{children:"\xdcberpr\xfcft Datenformat und Struktur"}),"\n",(0,r.jsx)(n.li,{children:"Pr\xfcft die Datenintegrit\xe4t in exportierten Dateien"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"N\xfctzlich, um sicherzustellen, dass CSV-Exporte vor Releases ordnungsgem\xe4\xdf funktionieren."}),"\n",(0,r.jsx)(n.h2,{id:"temporarily-block-ntfy-server-for-testing",children:"NTFY-Server vor\xfcbergehend blockieren (zum Testen)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo ./scripts/temporary_ntfy.sh_block.sh\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Dieses Skript blockiert vor\xfcbergehend den ausgehenden Netzwerkzugriff auf den NTFY-Server (",(0,r.jsx)(n.code,{children:"ntfy.sh"}),"), um den Wiederholungsmechanismus f\xfcr Benachrichtigungen zu testen. Es:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"L\xf6st die IP-Adresse des NTFY-Servers auf"}),"\n",(0,r.jsx)(n.li,{children:"F\xfcgt eine iptables-Regel hinzu, um ausgehenden Datenverkehr zu blockieren"}),"\n",(0,r.jsx)(n.li,{children:"Blockiert f\xfcr 10 Sekunden (konfigurierbar)"}),"\n",(0,r.jsx)(n.li,{children:"Entfernt die Blockierungsregel beim Beenden automatisch"}),"\n",(0,r.jsx)(n.li,{children:"Erfordert Root-Berechtigungen (sudo)"}),"\n"]}),"\n",(0,r.jsxs)(n.div,{className:"markdown-alert markdown-alert-caution",children:["\n",(0,r.jsxs)(n.p,{className:"markdown-alert-title",children:[(0,r.jsx)(n.span,{className:"octicon octicon-caution",style:{"--oct-icon":"url(\"data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' class='octicon octicon-stop mr-2' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z'%3E%3C/path%3E%3C/svg%3E\")"}}),"Caution"]}),"\n",(0,r.jsx)(n.p,{children:"Dieses Skript \xe4ndert iptables-Regeln und erfordert Root-Privilegien. Verwenden Sie es nur zum Testen von Benachrichtigungs-Wiederholungsmechanismen."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"database-migration-testing",children:"Datenbankmigrationstests"}),"\n",(0,r.jsx)(n.p,{children:"Das Projekt enth\xe4lt Skripte zum Testen von Datenbankmigrationen von \xe4lteren Versionen zur aktuellen Version. Diese Skripte stellen sicher, dass Datenbankmigrationen korrekt funktionieren und die Datenintegrit\xe4t bewahrt bleibt."}),"\n",(0,r.jsx)(n.h3,{id:"generate-migration-test-data",children:"Migrationstestdaten generieren"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./scripts/generate-migration-test-data.sh\n"})}),"\n",(0,r.jsx)(n.p,{children:"Dieses Skript generiert Testdatenbanken f\xfcr mehrere historische Versionen der Anwendung. Es:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stoppt und entfernt"})," jeden vorhandenen Docker-Container"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"F\xfcr jede Version"})," (v0.4.0, v0.5.0, v0.6.1, 0.7.27, 0.8.21):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Entfernt vorhandene Datenbankdateien"}),"\n",(0,r.jsx)(n.li,{children:"Erstellt eine Versions-Tag-Datei"}),"\n",(0,r.jsx)(n.li,{children:"Startet einen Docker-Container mit der spezifischen Version"}),"\n",(0,r.jsx)(n.li,{children:"Wartet, bis der Container bereit ist"}),"\n",(0,r.jsxs)(n.li,{children:["Generiert Testdaten mit ",(0,r.jsx)(n.code,{children:"pnpm generate-test-data"})]}),"\n",(0,r.jsx)(n.li,{children:"Erstellt einen Screenshot der Benutzeroberfl\xe4che mit Testdaten"}),"\n",(0,r.jsx)(n.li,{children:"Stoppt und entfernt den Container"}),"\n",(0,r.jsx)(n.li,{children:"Leert WAL-Dateien und speichert das Datenbankschema"}),"\n",(0,r.jsxs)(n.li,{children:["Kopiert die Datenbankdatei nach ",(0,r.jsx)(n.code,{children:"scripts/migration_test_data/"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Anforderungen:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Docker muss installiert und konfiguriert sein"}),"\n",(0,r.jsx)(n.li,{children:"Google Chrome (\xfcber Puppeteer) muss installiert sein"}),"\n",(0,r.jsx)(n.li,{children:"Root-/sudo-Zugriff f\xfcr Docker-Operationen"}),"\n",(0,r.jsxs)(n.li,{children:["Das Docker-Volume ",(0,r.jsx)(n.code,{children:"duplistatus_data"})," muss vorhanden sein"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Ausgabe:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Datenbankdateien: ",(0,r.jsx)(n.code,{children:"scripts/migration_test_data/backups_<VERSION>.db"})]}),"\n",(0,r.jsxs)(n.li,{children:["Schemadateien: ",(0,r.jsx)(n.code,{children:"scripts/migration_test_data/backups_<VERSION>.schema"})]}),"\n",(0,r.jsxs)(n.li,{children:["Screenshots: ",(0,r.jsx)(n.code,{children:"scripts/migration_test_data/duplistatus_test_data_<VERSION>.png"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Konfiguration:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Anzahl der Server: Wird \xfcber die Variable ",(0,r.jsx)(n.code,{children:"SERVERS"})," festgelegt (Standard: 3)"]}),"\n",(0,r.jsxs)(n.li,{children:["Datenverzeichnis: ",(0,r.jsx)(n.code,{children:"/var/lib/docker/volumes/duplistatus_data/_data"})]}),"\n",(0,r.jsx)(n.li,{children:"Port: 9666 (Docker-Container-Port)"}),"\n"]}),"\n",(0,r.jsxs)(n.div,{className:"markdown-alert markdown-alert-caution",children:["\n",(0,r.jsxs)(n.p,{className:"markdown-alert-title",children:[(0,r.jsx)(n.span,{className:"octicon octicon-caution",style:{"--oct-icon":"url(\"data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' class='octicon octicon-stop mr-2' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z'%3E%3C/path%3E%3C/svg%3E\")"}}),"Caution"]}),"\n",(0,r.jsxs)(n.p,{children:["Dieses Skript erfordert Docker und stoppt/entfernt vorhandene Container. Es erfordert auch sudo-Zugriff f\xfcr Docker-Operationen und Dateisystemzugriff. Das Skript ",(0,r.jsx)(n.code,{children:"pnpm take-screenshots"})," muss zuerst ausgef\xfchrt werden, um Google Chrome zu installieren, falls noch nicht geschehen."]}),"\n"]}),"\n",(0,r.jsxs)(n.div,{className:"markdown-alert markdown-alert-important",children:["\n",(0,r.jsxs)(n.p,{className:"markdown-alert-title",children:[(0,r.jsx)(n.span,{className:"octicon octicon-important",style:{"--oct-icon":"url(\"data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' class='octicon octicon-report mr-2' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z'%3E%3C/path%3E%3C/svg%3E\")"}}),"Important"]}),"\n",(0,r.jsxs)(n.p,{children:["Dieses Skript sollte nur einmal ausgef\xfchrt werden. Bei neuen Versionen kann der Entwickler die Datenbankdatei und Screenshots direkt in das Verzeichnis ",(0,r.jsx)(n.code,{children:"scripts/migration_test_data/"})," kopieren. F\xfchren Sie w\xe4hrend der Entwicklung einfach das Skript ",(0,r.jsx)(n.code,{children:"./scripts/test-migrations.sh"})," aus, um die Migrationen zu testen."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"test-database-migrations",children:"Testen von Datenbankmigrationen"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./scripts/test-migrations.sh\n"})}),"\n",(0,r.jsx)(n.p,{children:"Dieses Skript testet Datenbankmigrationen von alten Versionen zur aktuellen Version (4.0). Es:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"F\xfcr jede Version"})," (v0.4.0, v0.5.0, v0.6.1, 0.7.27, 0.8.21):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Erstellt eine tempor\xe4re Kopie der Testdatenbank"}),"\n",(0,r.jsxs)(n.li,{children:["F\xfchrt den Migrationsprozess mit ",(0,r.jsx)(n.code,{children:"test-migration.ts"})," aus"]}),"\n",(0,r.jsx)(n.li,{children:"Validiert die Struktur der migrierten Datenbank"}),"\n",(0,r.jsx)(n.li,{children:"Pr\xfcft auf erforderliche Tabellen und Spalten"}),"\n",(0,r.jsx)(n.li,{children:"\xdcberpr\xfcft, dass die Datenbankversion 4.0 ist"}),"\n",(0,r.jsx)(n.li,{children:"Bereinigt tempor\xe4re Dateien"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Anforderungen:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Testdatenbanken m\xfcssen in ",(0,r.jsx)(n.code,{children:"scripts/migration_test_data/"})," vorhanden sein"]}),"\n",(0,r.jsxs)(n.li,{children:["Generiert durch vorheriges Ausf\xfchren von ",(0,r.jsx)(n.code,{children:"generate-migration-test-data.sh"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Ausgabe:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Farbcodierte Testergebnisse (gr\xfcn f\xfcr bestanden, rot f\xfcr fehlgeschlagen)"}),"\n",(0,r.jsx)(n.li,{children:"Zusammenfassung bestandener und fehlgeschlagener Versionen"}),"\n",(0,r.jsx)(n.li,{children:"Detaillierte Fehlermeldungen f\xfcr fehlgeschlagene Migrationen"}),"\n",(0,r.jsx)(n.li,{children:"Exit-Code 0, wenn alle Tests bestanden sind, 1 wenn einer fehlschl\xe4gt"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Was wird validiert:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Datenbankversion ist nach der Migration 4.0"}),"\n",(0,r.jsxs)(n.li,{children:["Alle erforderlichen Tabellen existieren: ",(0,r.jsx)(n.code,{children:"servers"}),", ",(0,r.jsx)(n.code,{children:"backups"}),", ",(0,r.jsx)(n.code,{children:"configurations"}),", ",(0,r.jsx)(n.code,{children:"users"}),", ",(0,r.jsx)(n.code,{children:"sessions"}),", ",(0,r.jsx)(n.code,{children:"audit_log"}),", ",(0,r.jsx)(n.code,{children:"db_version"})]}),"\n",(0,r.jsx)(n.li,{children:"Erforderliche Spalten existieren in jeder Tabelle"}),"\n",(0,r.jsx)(n.li,{children:"Datenbankstruktur ist korrekt"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Beispielausgabe:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"==========================================\nDatabase Migration Test Suite\n==========================================\n\nTesting migrations from old versions to version 4.0\nTest data directory: /path/to/migration_test_data\nTemporary directory: /path/to/migration_test_data/.tmp\n\n----------------------------------------\nTesting version: v0.4.0\n----------------------------------------\n  Copying database file to temporary location...\n  Running migration test...\n\u2705 Version v0.4.0: Migration test PASSED\n\n==========================================\nTest Summary\n==========================================\n\n\u2705 Passed versions (5):\n  \u2713 v0.4.0\n  \u2713 v0.5.0\n  \u2713 v0.6.1\n  \u2713 0.7.27\n  \u2713 0.8.21\n\nAll migration tests passed!\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Verwendung:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Run all migration tests\n./scripts/test-migrations.sh\n\n# Check exit code\necho $?  # 0 = all passed, 1 = some failed\n"})}),"\n",(0,r.jsxs)(n.div,{className:"markdown-alert markdown-alert-note",children:["\n",(0,r.jsxs)(n.p,{className:"markdown-alert-title",children:[(0,r.jsx)(n.span,{className:"octicon octicon-note",style:{"--oct-icon":"url(\"data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' class='octicon octicon-info mr-2' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z'%3E%3C/path%3E%3C/svg%3E\")"}}),"Note"]}),"\n",(0,r.jsxs)(n.p,{children:["Dieses Skript verwendet intern das TypeScript-Migrationstestskript (",(0,r.jsx)(n.code,{children:"test-migration.ts"}),"). Das Testskript validiert die Datenbankstruktur nach der Migration und stellt die Datenintegrit\xe4t sicher."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"set-smtp-test-configuration",children:"SMTP-Testkonfiguration festlegen"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm set-smtp-test-config <connectionType>\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Dieses Skript legt die SMTP-Testkonfiguration aus Umgebungsvariablen fest. Es akzeptiert einen ",(0,r.jsx)(n.code,{children:"connectionType"}),"-Parameter (",(0,r.jsx)(n.code,{children:"plain"}),", ",(0,r.jsx)(n.code,{children:"starttls"})," oder ",(0,r.jsx)(n.code,{children:"ssl"}),") und liest entsprechende Umgebungsvariablen mit Pr\xe4fixen (",(0,r.jsx)(n.code,{children:"PLAIN_"}),", ",(0,r.jsx)(n.code,{children:"STARTTLS_"}),", ",(0,r.jsx)(n.code,{children:"SSL_"}),"), um die SMTP-Konfiguration in der Datenbank zu aktualisieren."]}),"\n",(0,r.jsxs)(n.p,{children:["Bei einfachen Verbindungen liest das Skript die Umgebungsvariable ",(0,r.jsx)(n.code,{children:"PLAIN_SMTP_FROM"}),", um die erforderliche Absenderadresse festzulegen. Dies erm\xf6glicht das Testen verschiedener SMTP-Verbindungstypen ohne manuelle Datenbankaktualisierungen."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Verwendung:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Set Plain SMTP configuration\nPLAIN_SMTP_HOST=smtp.example.com \\\nPLAIN_SMTP_PORT=25 \\\nPLAIN_SMTP_FROM=noreply@example.com \\\npnpm set-smtp-test-config plain\n\n# Set STARTTLS configuration\nSTARTTLS_SMTP_HOST=smtp.example.com \\\nSTARTTLS_SMTP_PORT=587 \\\nSTARTTLS_SMTP_USERNAME=user@example.com \\\nSTARTTLS_SMTP_PASSWORD=password \\\npnpm set-smtp-test-config starttls\n\n# Set Direct SSL/TLS configuration\nSSL_SMTP_HOST=smtp.example.com \\\nSSL_SMTP_PORT=465 \\\nSSL_SMTP_USERNAME=user@example.com \\\nSSL_SMTP_PASSWORD=password \\\npnpm set-smtp-test-config ssl\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Anforderungen:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Die Anwendung muss ausgef\xfchrt werden"}),"\n",(0,r.jsx)(n.li,{children:"Umgebungsvariablen m\xfcssen mit dem entsprechenden Pr\xe4fix f\xfcr den Verbindungstyp gesetzt werden"}),"\n",(0,r.jsxs)(n.li,{children:["F\xfcr einfache Verbindungen ist ",(0,r.jsx)(n.code,{children:"PLAIN_SMTP_FROM"})," erforderlich"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"test-smtp-connection-type-cross-compatibility",children:"Testen des SMTP-Verbindungstyps \u2013 Plattform\xfcbergreifende Kompatibilit\xe4t"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm test-smtp-connections\n"})}),"\n",(0,r.jsx)(n.p,{children:"Dieses Skript f\xfchrt einen umfassenden 3x3-Matrix-Test durch, der \xfcberpr\xfcft, ob Konfigurationen, die f\xfcr einen Verbindungstyp vorgesehen sind, korrekt mit verschiedenen Verbindungstypen funktionieren. F\xfcr jeden Basis-Konfigurationstyp (plain, starttls, ssl) f\xfchrt das Skript:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Liest Umgebungsvariablen mit entsprechenden Pr\xe4fixen (",(0,r.jsx)(n.code,{children:"PLAIN_*"}),", ",(0,r.jsx)(n.code,{children:"STARTTLS_*"}),", ",(0,r.jsx)(n.code,{children:"SSL_*"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Testet alle drei Verbindungstypen durch \xc4nderung nur des Feldes ",(0,r.jsx)(n.code,{children:"connectionType"})]}),"\n",(0,r.jsx)(n.li,{children:"Sendet Test-E-Mails \xfcber die API"}),"\n",(0,r.jsx)(n.li,{children:"Erfasst Ergebnisse in einem Matrixformat"}),"\n",(0,r.jsx)(n.li,{children:"Zeigt eine Zusammenfassungstabelle an"}),"\n",(0,r.jsxs)(n.li,{children:["Speichert detaillierte Ergebnisse in ",(0,r.jsx)(n.code,{children:"smtp-test-results.json"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Verwendung:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Set environment variables for all three connection types\nPLAIN_SMTP_HOST=smtp.example.com \\\nPLAIN_SMTP_PORT=25 \\\nPLAIN_SMTP_FROM=noreply@example.com \\\nSTARTTLS_SMTP_HOST=smtp.example.com \\\nSTARTTLS_SMTP_PORT=587 \\\nSTARTTLS_SMTP_USERNAME=user@example.com \\\nSTARTTLS_SMTP_PASSWORD=password \\\nSSL_SMTP_HOST=smtp.example.com \\\nSSL_SMTP_PORT=465 \\\nSSL_SMTP_USERNAME=user@example.com \\\nSSL_SMTP_PASSWORD=password \\\npnpm test-smtp-connections\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Anforderungen:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Die Anwendung muss ausgef\xfchrt werden"}),"\n",(0,r.jsx)(n.li,{children:"Umgebungsvariablen m\xfcssen f\xfcr alle drei Verbindungstypen festgelegt sein"}),"\n",(0,r.jsx)(n.li,{children:"Das Skript validiert die verwendete Konfiguration durch detaillierte Protokollierung"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Erwartet Verhalten:"}),"\nKonfigurationen sollten nur mit ihrem vorgesehenen Verbindungstyp funktionieren (z. B. einfache Konfiguration funktioniert mit einfachem Verbindungstyp, schl\xe4gt aber mit STARTTLS/SSL fehl)."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Ausgabe:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Konsolenausgabe mit einer Zusammenfassungstabelle mit Testergebnissen"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"smtp-test-results.json"})," Datei mit detaillierten Testergebnissen f\xfcr jede Kombination aus Konfiguration und Verbindungstyp"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"test-docker-entrypoint-script",children:"Testen des Docker-Entrypoint-Skripts"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pnpm test-entrypoint\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Dieses Skript bietet einen Test-Wrapper f\xfcr ",(0,r.jsx)(n.code,{children:"docker-entrypoint.sh"})," in der lokalen Entwicklung. Es richtet die Umgebung ein, um die Protokollierungsfunktionalit\xe4t des Einstiegspunkts zu testen, und stellt sicher, dass Protokolle in ",(0,r.jsx)(n.code,{children:"data/logs/"})," geschrieben werden, damit die Anwendung darauf zugreifen kann."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Was es tut:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Erstellt immer eine neue Version"}),": F\xfchrt automatisch ",(0,r.jsx)(n.code,{children:"pnpm build-local"})," aus, um vor dem Testen einen neuen Build zu erstellen (kein manuelles Bauen erforderlich)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Erstellt den Cron-Service"}),": Stellt sicher, dass der Cron-Service erstellt wird (",(0,r.jsx)(n.code,{children:"dist/cron-service.cjs"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Richtet eine Docker-\xe4hnliche Struktur ein"}),": Erstellt notwendige Symlinks und Verzeichnisstrukturen, um die Docker-Umgebung nachzuahmen"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"F\xfchrt das Entrypoint-Skript aus"}),": F\xfchrt ",(0,r.jsx)(n.code,{children:"docker-entrypoint.sh"})," mit den richtigen Umgebungsvariablen aus"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"R\xe4umt auf"}),": Entfernt automatisch tempor\xe4re Dateien beim Beenden"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Verwendung:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Run the test (builds fresh version automatically)\npnpm test-entrypoint\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Umgebungsvariablen:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"PORT=8666"})," - Port f\xfcr den Next.js-Server (entspricht ",(0,r.jsx)(n.code,{children:"start-local"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"CRON_PORT=8667"})," - Port f\xfcr den Cron-Service"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"VERSION"})," - Wird automatisch im Format ",(0,r.jsx)(n.code,{children:"test-YYYYMMDD-HHMMSS"})," gesetzt"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Ausgabe:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Protokolle werden in ",(0,r.jsx)(n.code,{children:"data/logs/application.log"})," geschrieben (zug\xe4nglich durch die Anwendung)"]}),"\n",(0,r.jsx)(n.li,{children:"Die Konsolenausgabe zeigt die Ausf\xfchrung des Einstiegspunktskripts"}),"\n",(0,r.jsx)(n.li,{children:"Dr\xfccken Sie Strg+C zum Stoppen und Testen der Protokollpufferung"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Anforderungen:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Das Skript muss aus dem Repository-Stammverzeichnis ausgef\xfchrt werden (pnpm handhabt dies automatisch)"}),"\n",(0,r.jsx)(n.li,{children:"Das Skript handhabt automatisch alle Voraussetzungen (Build, Cron-Service usw.)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Lokales Testen von \xc4nderungen am Entrypoint-Skript vor der Docker-Bereitstellung"}),"\n",(0,r.jsx)(n.li,{children:"\xdcberpr\xfcfung der Protokollrotation und Protokollierungsfunktionalit\xe4t"}),"\n",(0,r.jsx)(n.li,{children:"Testen von ordnungsgem\xe4\xdfem Herunterfahren und Signalbehandlung"}),"\n",(0,r.jsx)(n.li,{children:"Debugging des Verhaltens von Entrypoint-Skripten in einer lokalen Umgebung"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},73230(e,n,s){s.d(n,{R:()=>l,x:()=>a});var i=s(71299);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);